{% extends "::base.html.twig" %}

{% block style %}
	<style>
		.foro>td{
			background-color:transparent !important;
			padding:0px !important;
			vertical-align:middle !important;
		}
		.foro:hover{
			background-color:#f5f5f5;
			cursor:  pointer;
		}
		.foro>td>div{
			padding:10px 15px;
			color: #333;
			vertical-align:middle;
		}

        .ui-helper-hidden-accessible {
             display: none;
        }
        .ui-menu .ui-menu-item a{
            background: transparent;
            background-color: transparent;
            height:15px;
            font-size:15px;
            width: 500px !important;
            border: 1px solid #F3F0F0;
            padding-left: 10px;
            padding-right: 90px;
        }
        .ui-widget-content {
            background-color: transparent !important;
        }

	</style>
	<link href="{{ asset('rateit/src/rateit.css')}}" rel="stylesheet" type="text/css">
{% endblock style %}

{% block body %}

	<div class="row">
		<div class="col-lg-12">
			<section class="panel">
				<header class="panel-heading">{# formulario_info.nombre #}{% trans from "label" %}usuarios.mentor{% endtrans %}</header>
				<div class="panel-body">{# formulario_info.encabezado #}{% trans from "label" %}descripcion.usuarios.mentor{% endtrans %}</div>
                
                {% if contactos %}
					<table class="table table-striped border-top datatable">
						<thead>
							<tr>
								<th></th>
								<th>{% trans from "label" %}apellido{% endtrans %}</th>
								<th>{% trans from "label" %}nombre{% endtrans %}</th>
								{#<th>{% trans from "label" %}rol{% endtrans %}</th>#}
								<th>{% trans from "label" %}alternativas{% endtrans %}</th>
								<th>{% trans from "label" %}colegio{% endtrans %}/{% trans from "label" %}universidad{% endtrans %}</th>
								<th>{% trans from "label" %}opciones{% endtrans %}</th>
								
							</tr>
						</thead>
						<tbody>
							{% for c in contactos %}
								{% set pathUser = path('perfil', {'perfilId': c.id }) %}
								<tr class="foro" id='rel_{{ c.relacionId }}'>
									<td class='href' data-href='{{ pathUser }}'>
										{% set imagen = (c.usuarioImagen) ? c.usuarioImagen ~ '?type=large' : gui_default_img %}
										<div><img src="{{ asset(imagen) }}" alt="" STYLE='width:50px'></div>
									</td>
									<td class='href' data-href='{{ pathUser }}'><div>{{ c.usuarioApellido }}</div></td>
									<td class='href' data-href='{{ pathUser }}'><div>{{ c.usuarioNombre }}</div></td>
									{#<td class='href' data-href='{{ pathUser }}'><div>{{ c.rolNombre|trans({}, 'db') }}</div></td>#}
									<td class='href' data-href='{{ pathUser }}'>
										<div>
										{% if c.estudios is defined %}
												{% for est in c.estudios %}
													- {{ est.nombreCarrera }}<br>
												{% endfor %}
											{% else %}
												{% trans from "label" %}no.ha.sido.suministrada{% endtrans %}
											{% endif %}
											</div>
									</td>
									<td class='href' data-href='{{ pathUser }}'>
										<div>
											{% set colegio = (c.nombreColegio) ? c.nombreColegio : 'no.ha.sido.suministrado'|trans({}, 'label')  %}
											{% set grado = (c.usuarioCursoActual) ? " ("  ~ c.usuarioCursoActual ~ ")" : '' %}
											{{ colegio }}{{ grado }}
											
											
										</div>
									</td>
									<td class="text-center">
										<a STYLE='margin:2px;width:90%;' href='{{ pathUser }}' type="button" class="btn btn-primary btn-xs">{{ 'ver.perfil'|trans({}, 'label') }}</a>
										<a STYLE='margin:2px;width:90%;' class="btn btn-primary btn-xs" data-toggle="modal" href="#myModal{{ c.id }}">{{ 'agregar.informe.mercado.laboral'|trans({}, 'label') }}</a>
										<br>
										
										<div class="modal fade" id="myModal{{ c.id }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
											<div class="modal-dialog">
												<div class="modal-content">
													<form action="{{ path('subir_informe_mercado_laboral') }}" method='post' type="post" enctype="multipart/form-data">
														<div class="modal-header">
															<button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
															<h4 class="modal-title">{% trans from "label" %}informe.mercado.laboral{% endtrans %}</h4>
														</div>
														<div class="modal-body">
															{% set name =  c.usuarioNombre ~ ' ' ~ c.usuarioApellido %}
															<p>{{ 'subir.informe.mercado.laboral.de.alternativas.de.estudio.de.%name%'|trans({'%name%': name}, 'label') }}</p>
															<input type='hidden' name='usuario' value='{{ c.id }}' class="form-control" />
															<div STYLE='display:inline;'>
																<input required type='file' name='informeml' value='{{ c.id }}' class="form-control" STYLE='width:60%'/>
															</div>
														</div>
														<div class="modal-footer">
															<button data-dismiss="modal" class="btn btn-default" type="button">Close</button>
															<button class="btn btn-success" type="submit">Save changes</button>
														</div>
													</form>
												</div>
											</div>
										</div>
						
									</td>
								</tr>
							{% endfor %}
						</tbody>
					</table>
				{% else %}
					<div class="panel-body" STYLE='text-align:center;'>
                        {% trans from "label" %}no.hay.coincidencias.en.la.busqueda{% endtrans %}
					</div>
				{% endif %}
			</section>
			<hr>
				<div class="panel-body text-center">
					<a href="{{ path('perfil', { 'perfilId': sess_user.id }) }}" type="button" class="btn btn-shadow btn-primary">{% trans from "label" %}ver.perfil{% endtrans %}</a>
					<a href="{{ path('diagnostico') }}" type="button" class="btn btn-shadow btn-primary">{% trans from "label" %}anterior{% endtrans %}</a>
					<a href='{{ path('test_vocacional') }}'type="button" class="btn btn-shadow btn-primary">{% trans from "label" %}continuar.programa{% endtrans %}</a>
				</div>
		</div>
	</div>
{% endblock body %}

{% block script %}
    
    <script type="text/javascript" src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
    <script type="text/javascript" src="{{ asset('assets/data-tables/jquery.dataTables.js') }}"></script>
    <script type="text/javascript" src="{{ asset('assets/data-tables/DT_bootstrap.js') }}"></script>
    <script type="text/javascript" src="{{ asset('js/vocationet/datatables.js') }}"></script>
    <script type="text/javascript" src="{{ asset('rateit/src/jquery.rateit.js') }}"></script>

    <script>

  
		$('.table').on('click', '.href', function(){
			//window.location = $(this).data('href');
		});

		// Evento de click del btn seleccionar mentor, que envia el form.
		$('.table').on('click', '.seleccionarMentor', function(){
			var nameMentor = $(this).data('info');
			translateConfirm = '{{ 'confirmacion.mentor.%name%'|trans({'%name%': "nameMentor" }, 'label') }}';
			translateConfirm = translateConfirm.replace("nameMentor", nameMentor);
			if (confirm(translateConfirm)) {
				$(this).parent().submit();
			}
		});
    </script>
{% endblock script%}

